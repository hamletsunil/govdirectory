# Gov Directory

A Next.js app serving free public data profiles for 290 US local governments.

## Tech Stack

- **Framework**: Next.js 16 + React 19 + TypeScript
- **Styling**: Tailwind CSS 4 (via PostCSS)
- **Data**: Static JSON city profiles in `public/data/cities/`
- **Deployment**: Vercel (from `main` branch)
- **Package manager**: npm (not bun, not yarn)

## Development Workflow

```bash
# 1. Install dependencies
npm install

# 2. Run dev server
npm run dev

# 3. Typecheck
npx tsc --noEmit

# 4. Lint
npm run lint

# 5. Build (must pass before pushing)
npm run build

# 6. Sync city data (regenerates public/data/cities/)
npm run sync-cities
```

## Project Structure

- `src/app/page.tsx` — Home page (city index)
- `src/app/[slug]/page.tsx` — Individual city profile page
- `src/components/city/` — All city-related UI components
- `src/lib/narrative.ts` — Converts CityProfile data into editorial prose
- `scripts/` — Data enrichment and sync scripts (Python + TS)
- `public/data/cities/` — Static JSON data files (committed for Vercel builds)
- `public/data/cities/_index.json` — City index with slug, name, state, population

## Hard Rules

- **Always run `npm run build` before pushing.** Vercel deploys from main — a broken build = broken prod.
- **Never edit `public/data/cities/*.json` by hand.** These are generated by scripts. Edit the scripts instead.
- **Use `npm`, not `bun` or `yarn`.** The lockfile is `package-lock.json`.
- **Keep `[slug]/page.tsx` manageable.** It's already ~35KB. Extract components into `src/components/city/` rather than growing it further.
- **All data rendering goes through `src/lib/narrative.ts`.** Don't format numbers or generate prose inline in components.
- **Use `@/*` path aliases** (maps to `./src/*`). No deep relative imports.
- **Tailwind CSS 4 via PostCSS** — styles go in `globals.css` or component-level. No CSS modules.
- **Static data is read at build time** using `fs.readFileSync` in server components. No client-side data fetching for city profiles.
- **Commit messages should be concise and descriptive.** Format: "Add/Fix/Update [what]: [brief why]"
